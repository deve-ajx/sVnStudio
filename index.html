<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EmAji Phones Store</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f0f0f;
  color:white;
}
header{
  background:black;
  padding:15px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.hamburger{
  font-size:28px;
  cursor:pointer;
}
.nav-menu{
  display:none;
  position:absolute;
  top:60px;
  right:20px;
  background:#111;
  padding:15px;
  border-radius:10px;
}
.nav-menu button{
  display:block;
  margin:8px 0;
  width:100%;
}
.container{
  padding:20px;
}
.card{
  background:#1c1c1c;
  padding:15px;
  margin:10px 0;
  border-radius:10px;
}
button{
  padding:8px 15px;
  background:orange;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
input,textarea{
  width:100%;
  margin:8px 0;
  padding:8px;
}
img{
  max-width:100%;
  border-radius:8px;
}
</style>
</head>

<body>

<header>
<h2>EmAji Phones Store</h2>
<div class="hamburger" id="hamburger">‚ò∞</div>
</header>

<div class="nav-menu" id="navMenu">
<button onclick="rateSite()">‚≠ê Rate Website</button>
<button onclick="openSecret()">üîê Enter Code</button>
</div>

<section class="container">
<h2>Our Premium iPhones</h2>

<div class="card">
<h3>iPhone 14 Pro Max</h3>
<p>‚Ç¶650,000</p>
</div>

<div class="card">
<h3>iPhone 13</h3>
<p>‚Ç¶450,000</p>
</div>

</section>

<!-- POSTS WILL APPEAR HERE -->
<section class="container">
<h2>Latest Updates</h2>
<div id="postsContainer"></div>
</section>

<!-- ADMIN PANEL -->
<section class="container" id="adminPanel" style="display:none;">
<h2>Owner Panel</h2>
<input type="file" id="postImage">
<textarea id="postText" placeholder="Write something..."></textarea>
<button onclick="addPost()">Post</button>
</section>

<!-- FIREBASE -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyD0CpkbFpoKPvB1akarURWyzwiwftOiq5g",
  authDomain: "studio-1d6b7.firebaseapp.com",
  databaseURL: "https://emaji-phones-store-default-rtdb.firebaseio.com/",
  projectId: "studio-1d6b7",
  storageBucket: "studio-1d6b7.firebasestorage.app",
  messagingSenderId: "808981598394",
  appId: "1:808981598394:web:fe6789050b9a39e288f283"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const postsRef = ref(db, "posts");

// HAMBURGER
document.getElementById("hamburger").onclick = () => {
  const menu = document.getElementById("navMenu");
  menu.style.display = menu.style.display === "block" ? "none" : "block";
};

// RATE
window.rateSite = function(){
  const rate = prompt("Rate our website from 1 to 5");
  if(rate){
    alert("Thank you for rating us " + rate + " ‚≠ê");
  }
}

// SECRET
window.openSecret = function(){
  const code = prompt("Enter secret code");
  if(code === "mymagickey120"){
    document.getElementById("adminPanel").style.display="block";
  } else {
    alert("Wrong code");
  }
}

// ADD POST
window.addPost = function(){
  const text = document.getElementById("postText").value;
  const imageFile = document.getElementById("postImage").files[0];

  if(!text && !imageFile) return;

  if(imageFile){
    const reader = new FileReader();
    reader.onload = function(e){
      push(postsRef,{
        text:text,
        image:e.target.result,
        created:Date.now()
      });
      document.getElementById("postText").value="";
      document.getElementById("postImage").value="";
    }
    reader.readAsDataURL(imageFile);
  } else {
    push(postsRef,{
      text:text,
      image:null,
      created:Date.now()
    });
    document.getElementById("postText").value="";
  }
}

// LOAD POSTS
onValue(postsRef,(snapshot)=>{
  const container=document.getElementById("postsContainer");
  container.innerHTML="";
  const data=snapshot.val();
  if(!data) return;

  Object.keys(data).reverse().forEach(key=>{
    const post=data[key];

    let div=document.createElement("div");
    div.className="card";

    if(post.image){
      div.innerHTML+=`<img src="${post.image}">`;
    }
    if(post.text){
      div.innerHTML+=`<p>${post.text}</p>`;
    }

    // Delete button only visible if admin open
    if(document.getElementById("adminPanel").style.display==="block"){
      div.innerHTML+=`<button onclick="deletePost('${key}')">Delete</button>`;
    }

    container.appendChild(div);
  });
});

// DELETE
window.deletePost = function(key){
  remove(ref(db,"posts/"+key));
}

</script>

</body>
</html>